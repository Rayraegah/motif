Motif.Page.include("Motif.Dom.Utility.js"),Motif.Page.include("Motif.Ui.Controls.Control.js"),Motif.Page.include("Motif.Ui.Controls.Toolbar.js"),Motif.Page.include("Motif.Ui.Controls.RichTextBox.js"),Motif.Ui.Controls.RichTextEditor=function(t){Motif.Utility.extend(this,"Motif.Ui.Controls.Control"),this.__class.push("Motif.Ui.Controls.RichTextEditor"),this.input=null,this.toolbar=null,this.editor=null,this.load=function(t){Motif.Page.log.write("Motif.Ui.Controls.RichTextEditor.load: Loading editor from element.");var e=Motif.Dom.Utility.getElementsByAttribute(t,"motifClass","Motif.Ui.Controls.Toolbar")[0];e&&(Motif.Page.log.write("Motif.Ui.Controls.RichTextEditor.load: Loading toolbar from element."),t.removeChild(e),this.toolbar.load(e)),Motif.Page.log.write("Motif.Ui.Controls.RichTextEditor.load: Loading richtextbox from element."),Motif.Ui.Css.removeClassName(t,"Motif-Ui-Controls-RichTextEditor"),this.editor.load(t.cloneNode(!0));var i=t.getAttribute("tabindex");return i&&(t.removeAttribute("tabindex"),this.editor.element.tabIndex=i),this.Motif$Ui$Controls$Control.load(t),null},this.setElement=function(t){for(Motif.Page.log.write("Motif.Ui.Controls.RichTextEditor.setElement: Setting the element."),this.Motif$Ui$Controls$Control.setElement(t);this.element.childNodes.length>0;)this.element.removeChild(this.element.childNodes[0]);this.element.appendChild(this.toolbar.element),this.element.appendChild(this.editor.element),this._setEditorHeight(),null!=this.element.parentNode&&(this.input.name=this.element.id,this.element.parentNode.insertBefore(this.input,this.element))},this.execute=function(t,e){this.editor.execute(t,e)},this.getValue=function(){return this.editor.getXhtml()},this.setValue=function(t){return this.editor.isReady?(this.document.body.innerHTML=t,void(this.input.value=t)):void new Motif.Delegate(this.setValue,[t],this,250,!0)},this._setEditorHeight=function(){this.editor.setHeight(this.getHeight()-this.toolbar.getHeight())},this._toolbarMousedown=function(t){this.editor.execute(t.getName())},this._toolbarMouseup=function(t){this.editor.window.focus()},this._updateInput=function(){this.input.value=this.editor.getXhtml()},this.main=function(t){this.input=document.createElement("input"),this.input.type="hidden",this.toolbar=new Motif.Ui.Controls.Toolbar,this.toolbar.attachEvent("onbuttonmousedown",new Function("button",this.referenceString()+"._toolbarMousedown(button);")),this.toolbar.attachEvent("onbuttonmouseup",new Function("button",this.referenceString()+"._toolbarMouseup(button);")),this.editor=new Motif.Ui.Controls.RichTextBox,this.editor.attachEvent("onblur",new Function(this.referenceString()+"._updateInput();")),this.editor.attachEvent("onready",new Function(this.referenceString()+"._updateInput();")),t&&this.configure(t)},this.main(t)};