Motif.Dom.Selection=function(e){Motif.Utility.extend(this,"Motif.Object"),this.__class.push("Motif.Dom.Selection"),this.type=null,this.element=null,this._window=null,this._selection=null,this.load=function(e){this._window=e,Motif.BrowserInfo.internetExplorer?this._loadExplorer():this._loadGecko()},this.reload=function(){this.load(this._window)},this._loadExplorer=function(){Motif.Page.log.write("Motif.Dom.Selection.loadExplorer: Starting explorer loading."),this.element=null,this.type=null,this.selection=null;var e=null;try{this.selection=this._window.document.selection,e=this.selection.createRange()}catch(t){return void Motif.Page.log.write("Motif.Dom.Selection.loadExplorer: Failed to create range from selection.\r\n"+t.description)}this.selection&&(this.type=this.selection.type.toLowerCase(),Motif.Page.log.write("Motif.Dom.Selection.loadExplorer: Selection set, type determined '"+this.type+"'."),"control"==this.type&&e&&e.item?(Motif.Page.log.write("Motif.Dom.Selection.loadExporer: Type 'control using range.item(0) for element."),this.element=e.item(0)):(Motif.Page.log.write("Motif.Dom.Selection.loadExplorer: Type 'text' using parentElement() for element."),this.element=e.parentElement()))},this._loadGecko=function(){if(Motif.Page.log.write("Motif.Dom.Selection.loadGecko: Starting gecko loading."),this.selection=this._window.getSelection(),this.type=null,this.element=null,this.selection&&1==this.selection.rangeCount){Motif.Page.log.write("Motif.Dom.Selection.loadGecko: Selection and rangeCount.");var e=this.selection.getRangeAt(0);if(e.startContainer==e.endContainer&&e.endOffset-e.startOffset==1)Motif.Page.log.write("Motif.Dom.Selection.loadGecko: Type 'control' determined, getting element from anchorNode."),this.type="control",this.element=this.selection.anchorNode.childNodes[this.selection.anchorOffset];else{Motif.Page.log.write("Motif.Dom.Selection.loadGecko: Type 'text' determined getting parent from anchorNode."),this.type="text";for(var t=this.selection.anchorNode;t&&1!=t.nodeType;)t=t.parentNode;this.element=t}}},this.main=function(e){e&&this.load(e)},this.main(e)};