Motif.Page.include("Motif.Ui.Controls.Control.js"),Motif.Page.include("Motif.Collections.Hashtable.js"),Motif.Page.include("Motif.Dom.Utility.js"),Motif.Page.include("Motif.Ui.Css.js"),Motif.Page.include("Motif.Ui.Utility.js"),Motif.Ui.Controls.Menu=function(t){Motif.Utility.extend(this,"Motif.Ui.Controls.Control"),this.__class.push("Motif.Ui.Controls.Menu"),this.parent=null,this.items=new Motif.Ui.Controls.MenuItemCollection({parent:this}),this.load=function(t){this.Motif$Ui$Controls$Control.load(t);var i=Motif.Dom.Utility.getChildElements(t,"div","Item");i=i.concat(Motif.Dom.Utility.getElementsByAttribute(t,"motifclass","Motif.Ui.Controls.MenuItem"));for(var e=0;e<i.length;e++){var n=new Motif.Ui.Controls.MenuItem;n.load(i[e]),this.items.add(n)}},this.configure=function(t){return t=this.Motif$Ui$Controls$Control.configure(t),t.parent&&(this.parent=t.parent),t},this._blur=function(){if(null==this.parent)for(var t=this.items.toArray(),i=0;i<t.length;i++)t[i].deactivate()},this._mouseOver=function(){null==this.parent&&(this.element.tabIndex=-1,this.element.focus())},this.main=function(t){t&&this.configure(t),this.attachEvent("onmouseover",this._mouseOver),this.attachEvent("onblur",this._blur)},this.main(t)},Motif.Ui.Controls.MenuItem=function(t){Motif.Utility.extend(this,"Motif.Ui.Controls.Control"),this.__class.push("Motif.Ui.Controls.MenuItem"),this.parent=null,this.menu=null,this.name="",this.active=!1,this.load=function(t){this.Motif$Ui$Controls$Control.load(t);var i=Motif.Dom.Utility.getChildElements(t,"div","Menu")[0];i||(i=Motif.Dom.Utility.getElementsByAttribute(t,"motifclass","Motif.Ui.Controls.Menu")[0]),""!=this.element.id&&(this.name=this.element.id),""==this.name.length&&""!=this.element.name&&(this.name=this.element.name),""==this.name.length&&(this.name="MenuItem"+this.ptr.toString()),i&&(Motif.Page.log.write("Motif.Ui.Controls.MenuItem.load: Adding menu."),Motif.Ui.Css.removeClassName(i,"Menu"),i.removeAttribute("motifClass"),this.menu=new Motif.Ui.Controls.Menu({parent:this}),this.menu.load(i))},this.getParentItems=function(){for(var t=[],i=this.parent;i;)Motif.Type.isMotifType(i,"Motif.Ui.Controls.MenuItem")&&t.push(i),i=i.parent;return t},this.getChildItems=function(){var t=[];if(this.menu){var i=this.menu.items.toArray();t=t.concat(i);for(var e=0;e<i.length;e++)t=t.concat(i[e].getChildItems())}return t},this.activate=function(){if(this.active!==!0){Motif.Page.log.write("Motif.Ui.Controls.MenuItem.activate: Activating '"+this.name+"'.");var t=this.fireEvent("onbeforeactivate");if(t!==!0){this.active=!0;for(var i=this.parent.toArray(),e=0;e<i.length;e++)i[e]!==this&&i[e].deactivate();if(null!==this.menu){this.menu.element.parentNode===this.element&&(this.menu.close(),this.menu.open());var n=this.getRectangle();this.menu.move(n.x+n.w,n.y),this.menu.show()}this.fireEvent("onactivate")}}},this.deactivate=function(){if(this.active!==!1){Motif.Page.log.write("Motif.Ui.Controls.MenuItem.deactivate: Deactivating '"+this.name+"'.");var t=this.fireEvent("onbeforedeactivate");if(t!==!0){if(this.active=!1,this.menu){for(var i=this.getChildItems(),e=0;e<i.length;e++)i[e].deactivate();this.menu.hide()}this.fireEvent("ondeactivate")}}},this._mouseOver=function(t){this.activate()},this.onbeforeactivate=function(){},this.onactivate=function(){},this.onbeforedeactivate=function(){},this.ondeactivate=function(){},this.main=function(t){t&&this.configure(t),this.attachEvent("onmouseover",this._mouseOver)},this.main(t)},Motif.Ui.Controls.MenuItemCollection=function(t){Motif.Utility.extend(this,"Motif.Collections.Hashtable"),this.__class.push("Motif.Ui.Controls.Menu"),this.parent=null,this.add=function(t){t.parent=this,t.element.parentNode!=this.parent.element&&this.parent.element.appendChild(t.element),this.Motif$Collections$Hashtable.contains(t.name)&&this.Motif$Collections$Hashtable.remove(t.name),this.Motif$Collections$Hashtable.add(t.name,t)},this.remove=function(t){t.name&&(t=t.name);var i=this.Motif$Collections$Hashtable.remove(t);return i&&(this.parent.element.removeChild(i.element),i.parent=null),i},this.removeAll=function(){for(var t=this.Motif$Collections$Hashtable.removeAll(),i=0;i<t.length;i++)this.parent.element.removeChild(t[i].element),t[i].parent=null;return item},this.configure=function(t){return t=this.Motif$Collections$Hashtable.configure(t),t.parent&&(this.parent=t.parent),t},this.main=function(t){t&&this.configure(t)},this.main(t)};