Motif.Page.include("Motif.Ui.Devices.Screen.js"),Motif.Ui.Devices.MouseButtons={None:-1,Left:0,Center:1,Right:2},Motif.Ui.Devices.Mouse={_ieButtons:{b1:0,b4:1,b2:2},x:0,y:0,button:Motif.Ui.Devices.MouseButtons.None,trackers:{},trackerCount:0,register:function(e){0==Motif.Ui.Devices.Mouse.trackerCount&&Motif.Ui.Devices.Mouse._attachEvents();var t="tracker"+e.ptr.toString();t in Motif.Ui.Devices.Mouse.trackers||(Motif.Ui.Devices.Mouse.trackers[t]=e,Motif.Ui.Devices.Mouse.trackerCount++)},unregister:function(e){var t="tracker"+e.ptr.toString();t in Motif.Ui.Devices.Mouse.trackers&&(delete Motif.Ui.Devices.Mouse.trackers[t],Motif.Ui.Devices.Mouse.trackerCount--,0==Motif.Ui.Devices.Mouse.trackerCount&&Motif.Ui.Devices.Mouse._detachEvents())},_attachEvents:function(){Motif.Page.log.write("Motif.Ui.Devices.Mouse._attachEvents: Attaching events."),Motif.Utility.attachEvent(document,"onmousemove",Motif.Ui.Devices.Mouse._mouseMove),Motif.Utility.attachEvent(document,"onmousedown",Motif.Ui.Devices.Mouse._mouseDown),Motif.Utility.attachEvent(document,"onmouseup",Motif.Ui.Devices.Mouse._mouseUp),Motif.BrowserInfo.gecko?Motif.Utility.attachEvent(window,"onDOMMouseScroll",Motif.Ui.Devices.Mouse._mouseWheel):Motif.Utility.attachEvent(document,"onmousewheel",Motif.Ui.Devices.Mouse._mouseWheel)},_detachEvents:function(){Motif.Page.log.write("Motif.Ui.Devices.Mouse._detachEvents: Detaching events."),Motif.Utility.detachEvent(document,"onmousemove",Motif.Ui.Devices.Mouse._mouseMove),Motif.Utility.detachEvent(document,"onmousedown",Motif.Ui.Devices.Mouse._mouseDown),Motif.Utility.detachEvent(document,"onmouseup",Motif.Ui.Devices.Mouse._mouseUp),Motif.BrowserInfo.gecko?Motif.Utility.detachEvent(window,"onDOMMouseScroll",Motif.Ui.Devices.Mouse._mouseWheel):Motif.Utility.detachEvent(document,"onmousewheel",Motif.Ui.Devices.Mouse._mouseWheel)},_mouseMove:function(e){if(0==Motif.Ui.Devices.Mouse.trackers.length)return void Motif.Ui.Devices.Mouse._detachEvents();e=e||event;var t=e.clientX+Motif.Ui.Devices.Screen.getScrollLeft(),i=e.clientY+Motif.Ui.Devices.Screen.getScrollTop(),o=this.x!=t||this.y!=i;if(Motif.Ui.Devices.Mouse.x=t,Motif.Ui.Devices.Mouse.y=i,o)for(e in Motif.Ui.Devices.Mouse.trackers)Motif.Ui.Devices.Mouse.trackers[e].setPosition(t,i)},_mouseUp:function(e){var t=Motif.Ui.Devices.Mouse.button!=Motif.Ui.Devices.MouseButtons.None;if(Motif.Ui.Devices.Mouse.button=Motif.Ui.Devices.MouseButtons.None,t)for(e in Motif.Ui.Devices.Mouse.trackers)Motif.Ui.Devices.Mouse.trackers[e].setButton(Motif.Ui.Devices.MouseButtons.None)},_mouseDown:function(e){e=e||event;var t=Motif.BrowserInfo.internetExplorer?Motif.Ui.Devices.Mouse._ieButtons["b"+e.button.toString()]:e.button,i=Motif.Ui.Devices.Mouse.button!=t;if(Motif.Ui.Devices.Mouse.button=t,i)for(e in Motif.Ui.Devices.Mouse.trackers)Motif.Ui.Devices.Mouse.trackers[e].setButton(t)},_mouseWheel:function(e){e=e||event;var t=-1*e.detail||e.wheelDelta;t=0>t?-120:120;for(e in Motif.Ui.Devices.Mouse.trackers)Motif.Ui.Devices.Mouse.trackers[e].setWheelDelta(t)}},Motif.Ui.Devices.MouseTracker=function(e){Motif.Utility.extend(this,"Motif.Object"),this.__class.push("Motif.Ui.Devices.MouseTracker"),this.x=0,this.y=0,this.button=Motif.Ui.Devices.MouseButtons.None,this.isTracking=!1,this.wheelDelta=0,this.start=function(e){this.isTracking!==!0&&(e&&(Motif.Ui.Devices.Mouse.x=this.x=e.clientX+Motif.Ui.Devices.Screen.getScrollLeft(),Motif.Ui.Devices.Mouse.y=this.y=e.clientY+Motif.Ui.Devices.Screen.getScrollTop(),Motif.Ui.Devices.Mouse.button=this.button=Motif.BrowserInfo.internetExplorer?Motif.Ui.Devices.Mouse._ieButtons["b"+e.button.toString()]:e.button),this.fireEvent("onbeforestart"),Motif.Ui.Devices.Mouse.register(this),this.isTracking=!0,this.fireEvent("onstart"))},this.stop=function(){this.isTracking!==!1&&(this.fireEvent("onbeforestop"),Motif.Ui.Devices.Mouse.unregister(this),this.isTracking=!1,this.fireEvent("onstop"))},this.setPosition=function(e,t){if(this.x!=e||this.y!=t){var i=e-this.x,o=t-this.y;this.fireEvent("onpositionchange",[this.x,this.y,e,t,i,o]),this.x=e,this.y=t}},this.setButton=function(e){this.button!=e&&(this.fireEvent("onbuttonchange",[this.button,e]),this.button=e)},this.setWheelDelta=function(e){this.fireEvent("onwheel",[e]),this.wheelDelta=e},this.configure=function(e){e=this.Motif$Object.configure(e),Motif.Type.isNumber(e.x)&&(this.x=e.x),Motif.Type.isNumber(e.y)&&(this.y=e.y),Motif.Type.isNumber(e.button)&&(this.button=e.button)},this.toString=function(){return"x="+this.x+";y="+this.y+";b="+this.button+";w="+this.wheelDelta},this.onpositionchange=function(e,t,i,o,s,n){},this.onbuttonchange=function(e,t){},this.onwheel=function(e,t){},this.main=function(e){e&&this.configure(e)},this.main(e)};